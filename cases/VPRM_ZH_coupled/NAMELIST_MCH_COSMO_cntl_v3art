! parallel_nml: MPI parallelization -------------------------------------------
&parallel_nml
 nproma                      =                         8         ! loop chunk length
 p_test_run                  =                     .FALSE.        ! .TRUE. means verification run for MPI parallelization
 num_io_procs                =                        9 !  1         ! number of I/O processors
 num_restart_procs           =                          0         ! number of restart processors
 num_prefetch_proc           =                          1	   ! number of processors for LBC prefetching
 iorder_sendrecv             =                          3         ! sequence of MPI send/receive calls
 l_test_openmp  = .false.
 l_log_checks   = .false.
 write_div_to_file = .FALSE.
 use_omp_input = .TRUE.
/

! run_nml: general switches ---------------------------------------------------
&run_nml
ltestcase                   =                    .FALSE.         ! idealized testcase runs
 num_lev                     =                     80,80,80,80      ! number of full levels (atm.) for each domain
 lvert_nest                  =                      .FALSE.        ! vertical nesting
 dtime                       =                        10         ! timestep in seconds
 ldynamics                   =                     .TRUE.         ! compute adiabatic dynamic tendencies
 ltransport                  =                     .TRUE.         ! compute large-scale tracer transport
 ntracer                     =                          5         ! number of advected tracers
 iforcing                    =                          3         ! forcing of dynamics and transport by parameterized processes
 msg_level                   =                         15         ! controls how much printout is written during runtime
 ltimer                      =                      .TRUE.       ! timer for monitoring the runtime of specific routines
 timers_level                =                       5 !   10         ! performance timer granularity
check_uuid_gracefully       =                       .FALSE.        ! give only warnings for non-matching uuids
 profiling_output 	     = 				1       						!
 lart                        =                      .TRUE.        ! main switch for ART
 output                      =                       'nml','totint' ! "nml", "totint"  ! "nml"        ! main switch for enabling/disabling components of the model output
/
! art_nml: Aerosols and Reactive Trace gases extension-------------------------------------------------
&art_nml
 lart_chem                  =                        .TRUE.       ! enables chemistry
 lart_pntSrc                =                        .TRUE.       ! enables point sources
 lart_aerosol               =                       .FALSE.       ! main switch for the treatment of atmospheric aerosol
 lart_chemtracer            =                        .TRUE.       ! main switch for the treatment of chemical tracer
 lart_diag_out              =                        .TRUE.       ! If this switch is set to .TRUE., diagnostic
                                                                  ! ... output elds are available. Set it to
                                                                  ! ... .FALSE. when facing memory problems.
 iart_init_gas              =                            0
 iart_seasalt               =                            0        ! enable seasalt
 cart_chemtracer_xml        =                         "/work/bb1096/b380437/icon/icon_2te_budget_les/icon-nwp-grib2/icon-nwp/run/tracers_BRM_pntsrc.xml"       ! path to xml file for passive tracers
 cart_pntSrc_xml            =                         "/work/bb1096/b380437/icon/icon_2te_budget_les/icon-nwp-grib2/icon-nwp/run/pntSrc_BRM.xml"
 cart_input_folder          =                          '/work/bb1096/b380437/icon/icon_2te_budget_les/icon-nwp-grib2/icon-nwp/externals/art'       ! absolute Path to ART source code
/
&limarea_nml
 itype_latbc     = 1
 dtime_latbc     = 3600.
 nlev_latbc      = 80	
 latbc_boundary_grid         =   "lateral_boundary.grid.nc"       ! Grid file defining the lateral boundary
 latbc_path      = '/work/bb1096/b380437//IG3IS//CASES/20210808/BOUNDARY'
 latbc_varnames_map_file     =            'map_file.latbc'
 latbc_filename  = 'latbc_MCH_20200619_D01_DOM01_<y><m><d><h>.nc'
 init_latbc_from_fg          =                     .FALSE.        ! .TRUE.: take lbc for initial time from first guess
/
! diffusion_nml: horizontal (numerical) diffusion ----------------------------
&diffusion_nml
 lhdiff_vn                   =                      .TRUE.        ! diffusion on the horizontal wind field
 lhdiff_temp                 =                      .TRUE.        ! diffusion on the temperature field
 lhdiff_w                    =                      .TRUE.        ! diffusion on the vertical wind field
 hdiff_order                 =                          5         ! order of nabla operator for diffusion
 itype_vn_diffu              =                          1         ! reconstruction method used for Smagorinsky diffusion
 itype_t_diffu               =                          2         ! discretization of temperature diffusion
 hdiff_efdt_ratio            =                         24.0       ! ratio of e-folding time to time step
 hdiff_smag_fac              =                          0.025     ! scaling factor for Smagorinsky diffusion
/

! dynamics_nml: dynamical core -----------------------------------------------
&dynamics_nml
 iequations                  =                          3         ! type of equations and prognostic variables
 idiv_method                 =                          1         ! method for divergence computation
 divavg_cntrwgt              =                          0.50      ! weight of central cell for divergence averaging
 lcoriolis                   =                      .TRUE.        ! Coriolis force
/

! extpar_nml: external data --------------------------------------------------
&extpar_nml
itopo                       =                          1         ! topography (0:analytical)
!extpar_filename             =       		     "/work/bb1096/b380437//IG3IS//CASES/20200619/EXTPAR/extpar_hdcp2_1709_3D_0005km_nest.nc"		!extpar_DOM<idom>.nc filename of external parameter input file
 n_iter_smooth_topo          =                     1,1,1,1        ! iterations of topography smoother
 heightdiff_threshold        =                     2250., 1500. ! 800., 900. !2250.,1800.,1800.,1800.        		! height difference between neighb. grid points
 hgtdiff_max_smooth_topo     =                      750.,750.,750.,750.        ! see Namelist doc
 itype_vegetation_cycle      =                          3         ! gdm orig. 1 tweaks the annual cycle of LAI
 itype_lwemiss               =                          2
/
! initicon_nml: specify read-in of initial state ------------------------------
&initicon_nml
 init_mode                  =	   4  !  !4=cosmo, 2=ifs, 3=combined  start from initialized DWD analysis
 lread_ana                    = .FALSE.                    ! no analysis data will be read
 lp2cintp_incr                = .FALSE.
 lp2cintp_sfcana              = .FALSE.
 check_ana(1)%list            = 'P','QV','T','U','V'
 check_ana(2)%list            = 'FRESHSNW','H_SNOW','T_SO' ! NOOOOOOOOOOOOO in ens
 use_lakeiceana               = .TRUE.
 qcana_mode                   =  0           ! (0) no QC-increments,
                                            ! (1) QC+QV-increments added to QV,
                                            ! (2) QC-increments added to QC if already present at gridpoint
                                            !     and added to QV if not
 qiana_mode                   = 0           ! 0/1: ignore/use QI increments
 qrsgana_mode                 = 0           ! 0/1: ignore/use QR,QS,QG
! dwdfg_filename               = "laf.nc"    ! initial data filename init_mode 7
!dwdana_filename              = "<path>laf20201019230000_inc.det" ! init_mode 7
! filetype                     = -1
 ana_varnames_map_file        = "map_file.ana"        ! Dictionary for initial data file
 ltile_coldstart              = .TRUE.  ! coldstart for surface tiles
 ltile_init                   = .FALSE.  ! gdm origin .F. set it to .TRUE. if FG data originate from run without tiles 
! lconsistency_checks	= .FALSE.
 filetype	= 4
/
! grid_nml: horizontal grid --------------------------------------------------
&grid_nml
 dynamics_grid_filename      =   'MCH_20200619_D01_DOM01.nc',         ! array of the grid filenames for the dycore
! radiation_grid_filename     = '/work/bb1096/b380437//IG3IS//CASES/20200619/GRIDS/MCH_20200619_D01_DOM01.parent.nc'         ! array of the grid filenames for the radiation model
 dynamics_parent_grid_id     =     0         ! array of the indexes of the parent grid filenames
 lfeedback         = .false.,.false.,.false.,.false.
 l_limited_area    = .true.
! lredgrid_phys               =               .TRUE.,.TRUE.,.TRUE.,.TRUE.        ! .true.=radiation is calculated on a reduced grid
 ifeedback_type              =                          2         ! feedback type (incremental/relaxation-based)
! start_time                  =                 0.,  -5400.        ! Time when a nested domain starts to be active [s]
! end_time                    =                 0., 172800.        ! Time when a nested domain terminates [s]
! vertical_grid_filename = '/work/bb1096/b380437/icon/icon_2te_budget_les/icon-nwp-grib2/icon-nwp/vertical_coord_tables/atm_hyb_sz_80' 
/
! gridref_nml: grid refinement settings --------------------------------------
&gridref_nml
! grf_intmethod_e  = 6 
! grf_scalfbk      = 2
! grf_tracfbk      = 2
 denom_diffu_v    = 150.
! l_mass_consvcorr = .true. !.false.
! l_density_nudging = .true.  !.false.
/
! interpol_nml: settings for internal interpolation methods ------------------
&interpol_nml
 nudge_zone_width            =                    10         ! width of lateral boundary nudging zone
 nudge_max_coeff             =                          0.075     ! maximum relaxation coefficient for lateral boundary nudging
! lsq_high_ord      =  3
 support_baryctr_intp        =                      .FALSE.        ! barycentric interpolation support for output
/
! io_nml: general switches for model I/O -------------------------------------
&io_nml
 dt_checkpoint               =                        10800.0	   !!	10800       ! time interval for writing restart files.
 lnetcdf_flt64_output        =                      .TRUE.        ! double precision output
! lkeep_in_sync    = .true.
 itype_pres_msl              =                          5         ! method for computation of mean sea level pressure
 itype_rh                    =                          1         ! method for computation of relative humidity
 lmask_boundary              =                      .FALSE.       ! mask out interpolation zone in output
 output_nml_dict             =                 'dict.output.dwd'  ! maps output_nml variable names onto internal ICON names
 netcdf_dict                 =              'dict.output.empa.art'        ! specifies the names in the output netcdf file
! lnetcdf_flt64_output        =                      .TRUE.        ! double precision output
 lflux_avg                   =                     .FALSE.        ! fluxes are accumulated rather than averaged for output
 inextra_3d      = 20   !!!!!!!!!!!!!!!!! budget terms (9) and 2te terms (11)
 write_last_restart = .TRUE.
! restart_write_mode = 'async'  !"joint procs multifile"
 itype_dursun                =                          1         ! 0 or 1 only with new MR ldursun_mch for output of dursun_m/_r
 gust_interval               =                      3600.         ! Interval over which wind gusts are maximized
 maxt_interval               =                    "PT01H"         ! Interval over which max/min 2-m temperatures are calculated
/
&nonhydrostatic_nml
 iadv_rhotheta               =                          2         ! advection method for rho and rhotheta
 ivctype                     =                          2         ! type of vertical coordinate
 itime_scheme                =                          4         ! time integration scheme
 ndyn_substeps               =                          5         ! number of dynamics steps per fast-physics step
 exner_expol                 =                          0.333     ! temporal extrapolation of Exner function
 vwind_offctr                =                          0.2       ! off-centering in vertical wind solver
 damp_height                 =                      12500.0,12500.0,12500.0,12500.0       ! height at which Rayleigh damping of vertical wind starts
 rayleigh_coeff              =                      5.0,5.0,5.0,5.0,5.0 !!   1.5,1.5,1.5,1.5,1.5,1.5           ! Rayleigh damping coefficient
 divdamp_order               =                        24        !!!! order of divergence damping 
 divdamp_type                =                        32  ! 3          ! type of divergence damping
! lhdiff_rcf                  =                          .TRUE.
 divdamp_fac                 =                          0.004     ! scaling factor for divergence damping
 l_open_ubc                  =                          .FALSE. ! .TRUE.  ! .TRUE.=use open upper boundary condition
 igradp_method               =                          3         ! discretization of horizontal pressure gradient
 l_zdiffu_t                  =                      .TRUE.        ! specifies computation of Smagorinsky temperature diffusion
 thslp_zdiffu                =                          0.02      ! slope threshold (temperature diffusion)
 thhgtd_zdiffu               =                        125.0       ! threshold of height difference (temperature diffusion)
 htop_moist_proc             =                      22500.0       ! max. height for moist physics
 hbot_qvsubstep              =                      22500.0       ! height above which QV is advected with substepping scheme
/
! nwp_phy_nml: switches for the physics schemes ------------------------------
&nwp_phy_nml
 inwp_gscp                   =                          2,2,2        ! cloud microphysics and precipitation
 inwp_convection             =                          1,1,1        ! convection
 lgrayzone_deepconv          =                      .FALSE.,.FALSE.      !
 lshallowconv_only           =                      .TRUE.,.TRUE.        ! only shallow convection
 inwp_radiation              =                          4,4     ! radiation
 inwp_cldcover               =                          1,1         ! cloud cover scheme for radiation
 inwp_turb                   =                          1,1         ! vertical diffusion and transfer
 inwp_satad                  =                          1,1,1         ! saturation adjustment
 inwp_sso                    =                          1,1,1         ! subgrid scale orographic drag
 inwp_gwd                    =                          0,0,0         ! non-orographic gravity wave drag
 inwp_surface                =                          1,1,1         ! surface scheme
 latm_above_top              =                .TRUE.,.TRUE.,.TRUE.      ! take into account atmosphere above model top for radiation computation
 ldetrain_conv_prec          =                      .TRUE.,.TRUE.,.TRUE.
 efdt_min_raylfric           =                       7200.0       ! minimum e-folding time of Rayleigh friction
 itype_z0                    =                       2 ! 1   !!!! type of roughness length data : default, 2: turn off SSO part of z0 ! 2 for landuse, 1 for external        ! type of roughness length data
 icapdcycl                   =                          3         ! apply CAPE modification to improve diurnalcycle over tropical land
 icpl_aero_conv              =                          1 !!! should be true when inwp_gscp=1,2         ! coupling between autoconversion and Tegen aerosol climatology
 icpl_aero_gscp              =                        0 !  1 !!!! should be true when inwp_gscp=1        ! coupling between autoconversion and Tegen aerosol climatology
 lrtm_filename               =                'rrtmg_lw.nc'       ! longwave absorption coefficients for RRTM_LW
 cldopt_filename             =             'rrtm_cldopt.nc'       ! RRTM cloud optical properties
 mu_rain                     =                         0.5        ! shap parameter in gamma distribution for rain
 mu_snow		     =                         0.5
 rain_n0_factor              =                         0.1        ! tuning factor for intercept parameter of raindrop size distr.
 dt_rad                      =                         600.       ! time step for radiation in s
 dt_conv                     =                 120.,90.,90.       ! time step for convection in s (domain specific)
 dt_sso                      =               120.,360.,360.       ! time step for SSO parameterization
 dt_gwd                      =               120.,120.,120.       ! gdm : 360 in guenther
! dt_rad                      =                        480.,240.,120.,60.   ! 160.,160.  ! time step for radiation in s
! dt_conv                     =                  120.,90.,90.,60.       ! time step for convection in s (domain specific)
! dt_sso                      =                 120.,90.,90.,60.         ! 120.,360.,360.       ! time step for SSO parameterization
! dt_gwd                      =                 120.,90.,90.,60.         ! 120.,120.,120.       ! gdm : 360 in guenther
/
! nwp_tuning_nml: additional tuning parameters ----------------------------------
&nwp_tuning_nml
 tune_v0snow                 =                        25
 tune_rcucov                 =                        0.075
 tune_rhebc_land             =                        0.825
 tune_zvz0i                  =                        0.85
 itune_albedo                =                          1         ! reduced albedo (w.r.t. MODIS data) over Sahara
 tune_gkwake                 =                        0.25
 tune_gfrcrit                =                        0.333
 tune_gkdrag                 =                        0.0
 tune_minsnowfrac            =                        0.3
 tune_box_liq                =                        0.04
 tune_box_liq_asy            =                        4
! tune_box_liq_sfc_fac        =                        1.0
 tune_gust_factor            =                        7.0
! tune_zvz0i                  =                        1.25        ! new tuning since June 2018 ! gdm non in guenther
 tune_sgsclifac              =                        1.0         ! new tuning becoming operational in July 2019 ! gdm non in guenther
 icpl_turb_clc               =                        2
 max_calibfac_clcl           =                        2.0
/
&output_nml
 filetype                    =                          2         ! output format: 2=GRIB2, 4=NETCDFv2
 dom                         =                          1         ! write output only for EU-nest
 output_bounds               =                 0., 10000000., 120.     ! output: start, end, increment in s
 steps_per_file              =                          1 !12     ! 72 (actual)         ! number of output steps in one output file
 taxis_tunit                 =                          1
 remap                       =                          0         ! remap to regular lat/lon grid (0 or 1)
 output_grid                 =                      .TRUE.        ! flag whether grid information is added to output.
 output_filename             = 'MCH_R19B08_empa_i1'! file name base
 filename_format             = '<output_filename>_DOM<physdom>_<levtype>_<datetime2>' ! full output file format
 mode                        =                          1         ! 1: forecast mode (relative t-axis), 2: climate mode (absolute t-axis)
! EMPA:   HSURF, FR_LAND, U,V,ALHFL_S, ASHFL_S,ASOB_S,AUMFL_S,AVMFL_S,CLCT,P,PS,QV,RAIN_GSP,SNOW_GSP,T,T_2M,TD_2M,T_G,U_10M,V_10M,W,W_SNOW
 ml_varlist                  =  'topography_c','fr_land','u','v','acclhfl_s','accshfl_s','accsob_s','accumfl_s','accvmfl_s','clct','pres','ps','qv','rain_gsp','snow_gsp','t','t_2m','td_2m','t_g','u_10m','v_10m','w','w_snow','h_snow','rho_snow'
/
&output_nml
 filetype                    =                          2         ! output format: 2=GRIB2, 4=NETCDFv2
 dom                         =                          1         ! write output only for EU-nest
 output_bounds               =                 0., 10000000., 120.     ! output: start, end, increment in s
 steps_per_file              =                          1 !12     ! 72 (actual)         ! number of output steps in one output file
 taxis_tunit                 =                          1
 remap                       =                          0         ! remap to regular lat/lon grid (0 or 1)
 output_grid                 =                      .TRUE.        ! flag whether grid information is added to output.
 output_filename             = 'MCH_R19B08_empa_artvars'! file name base
 filename_format             = '<output_filename>_DOM<physdom>_<levtype>_<datetime2>' ! full output file format
 mode                        =                          1         ! 1: forecast mode (relative t-axis), 2: climate mode (absolute t-axis)
 ml_varlist                  = 'testtr12', 'testtr212' 
!'group:ART_CHEMISTRY','group:ART_DIAGNOSTICS','group:ART_PASSIVE','group:ART_AEROSOL'
/
! sleve_nml: vertical level specification -------------------------------------
&sleve_nml
 min_lay_thckn               =                         20.0       ! layer thickness of lowermost layer
! max_lay_thckn               =                        400.0       ! maximum layer thickness below htop_thcknlimit
! htop_thcknlimit             =                      14000.        ! height below which the layer thickness does not exceed max_lay_thckn
 top_height                  =                      22000.0       ! height of model top
 stretch_fac                 =                       0.65      ! stretching factor to vary distribution of model levels
 decay_scale_1               =                       4000.0       ! decay scale of large-scale topography component
 decay_scale_2               =                       2500.0       ! decay scale of small-scale topography component
 decay_exp                   =                          1.2       ! exponent of decay function
 flat_height                 =                      16000.0       ! height above which the coordinate surfaces are flat
/
! radiation_nml: radiation scheme ---------------------------------------------
&radiation_nml
 irad_o3                     =                          79         ! ozone climatology ! 7 GEMS ozone climatology (from IFS)-- it gives error in complex orography
 irad_aero                   =                          6         ! aerosols
 albedo_type                 =                          2         ! type of surface albedo
 vmr_co2                     =                    390.e-06
 vmr_ch4                     =                   1800.e-09
 vmr_n2o                     =                   322.0e-09
 vmr_o2                      =                     0.20946
 vmr_cfc11                   =                    240.e-12
 vmr_cfc12                   =                    532.e-12
 direct_albedo_water         =                           3
 albedo_whitecap             =                           1
 ecrad_data_path             =             "/work/bb1096/b380437/icon/icon_2te_budget_les/icon-nwp-grib2/icon-nwp/externals/ecrad/data/"  !'./ecrad_data'  ! Optical property files path ecRad (link files as path is truncated inside ecrad)
/
! transport_nml: tracer transport ---------------------------------------------
&transport_nml
 ivadv_tracer                =              3, 3, 3, 3         ! tracer specific method to compute vertical advection
 itype_hlimit                =              3, 4, 4, 4         ! type of limiter for horizontal transport
 itype_vlimit                =              1, 1, 1, 1         ! gdm: 1: semi-monotone slope limiter orig. 2: monotonous type of limiter for vertical transport
 ihadv_tracer                =             52, 2, 2, 2         ! tracer specific method to compute horizontal advection
 llsq_svd                    =                      .TRUE.        ! use SV decomposition for least squares design matrix
/
! turbdiff_nml: turbulent diffusion -------------------------------------------
&turbdiff_nml
 tkhmin                      =                          0.5       ! scaling factor for minimum vertical diffusion coefficient
 tkmmin                      =                          0.75      ! scaling factor for minimum vertical diffusion coefficient
 pat_len                     =                        750.0       ! effective length scale of thermal surface patterns
 tur_len                     =                        300.0       ! asymptotic maximal turbulent distance
 rat_sea                     =                          0.8       ! controls laminar resistance for sea surface
 ltkesso                     =                        .TRUE.      ! consider TKE-production by sub-grid SSO wakes
 frcsmot                     =                          0.2       ! these 2 switches together apply vertical smoothing of the TKE source terms
 imode_frcsmot               =                            2       ! in the tropics (only), which reduces the moist bias in the tropical lower troposphere
 itype_sher                  =                            2       ! type of shear forcing used in turbulence
 ltkeshs                     =                        .TRUE.      ! include correction term for coarse grids in hor. shear production term
 a_hshr                      =                          2.0       ! length scale factor for separated horizontal shear mode
 icldm_turb                  =                            2       ! mode of cloud water representation in turbulence
 q_crit                      =                          2.0       ! critical value for normalized supersaturation
 imode_tkesso                =                            2       ! mode of calculating th SSO source term for TKE production
 rlam_heat                   =                         10.0       ! gdm default seems to be 10 in code but 1 in Namelist_overview.pdf
 alpha1                      =                         0.125
/
&les_nml
 smag_constant     = 0.23
 isrfc_type        = 1  !1=TERRA,2=Fixed flux, 5=fixed SST, 3=fixed bflux
! expname          = 'MCH_COSMO_cntl_v3art'
 avg_interval_sec = 300.
 sampl_freq_sec   = 30.
 ldiag_les_out    = .FALSE. !.TRUE.
 km_min           = 0.0
 les_metric=.TRUE.
/
&lnd_nml
 ntiles                      =                          3         ! number of tiles
 nlev_snow                   =                          3         ! number of snow layers
 lmulti_snow                 =                      .FALSE.       ! .TRUE. for use of multi-layer snow model
 idiag_snowfrac              =                         20         ! type of snow-fraction diagnosis
 lsnowtile                   =                       .TRUE.       ! .TRUE.=consider snow-covered and snow-free separately
 itype_root                  =                          2         ! root density distribution
 itype_heatcond              =                          3         ! type of soil heat conductivity
 itype_lndtbl                =                          4         ! table for associating surface parameters
 itype_evsl                  =                          4         ! type of bare soil evaporation
 itype_root                  =                          2         ! root density distribution
 cwimax_ml                   =                      5.e-4         ! scaling parameter for max. interception storage
 c_soil                      =                       1.25         ! surface area density of the evaporative soil surface
 c_soil_urb                  =                        0.5         ! same for urban areas
 lseaice                     =                      .FALSE.        ! .TRUE. for use of sea-ice model
 llake                       =                      .TRUE.        ! .TRUE. for use of lake model
 itype_canopy                =                          2         ! Jan Peter scheme gdm orig. default 1
 itype_snowevap              =                          3         ! gdm: orig.: 2 Snow evap. in vegetated areas with add. variables for snow age and max. snow height
 itype_trvg                  =                          3         ! BATS scheme with add. prog. var. for integrated plant transpiration since sunrise
 sstice_mode                 =                          2         ! 2: SST is updated on a daily basis by climatological increments
/
